(self.webpackChunkliminal_app=self.webpackChunkliminal_app||[]).push([["node_modules_web3auth_wallet-connect-v1-adapter_dist_walletConnectV1Adapter_esm_js","_da9b-_96ce-_a993-_7e2d-_2b6a"],{21357:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "WalletConnectV1Adapter": () => (/* binding */ WalletConnectV1Adapter)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4942);\n/* harmony import */ var _walletconnect_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(29409);\n/* harmony import */ var _web3auth_base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(17291);\n/* harmony import */ var _web3auth_ethereum_provider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(52062);\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2043);\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nclass WalletConnectV1Adapter extends _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .BaseAdapter */ .J5 {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "name", _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WALLET_ADAPTERS.WALLET_CONNECT_V1 */ .rW.WALLET_CONNECT_V1);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "adapterNamespace", _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_NAMESPACES.EIP155 */ .yk.EIP155);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "currentChainNamespace", _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .CHAIN_NAMESPACES.EIP155 */ .EN.EIP155);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "type", _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_CATEGORY.EXTERNAL */ .hN.EXTERNAL);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "adapterOptions", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "status", _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.NOT_READY */ .MP.NOT_READY);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "adapterData", {\n      uri: ""\n    });\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "connector", null);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "wcProvider", null);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(this, "rehydrated", false);\n\n    this.adapterOptions = _objectSpread({}, options);\n    this.chainConfig = options.chainConfig || null;\n  }\n\n  get connected() {\n    var _this$connector;\n\n    return !!((_this$connector = this.connector) !== null && _this$connector !== void 0 && _this$connector.connected);\n  }\n\n  get provider() {\n    var _this$wcProvider;\n\n    return ((_this$wcProvider = this.wcProvider) === null || _this$wcProvider === void 0 ? void 0 : _this$wcProvider.provider) || null;\n  }\n\n  set provider(_) {\n    throw new Error("Not implemented");\n  }\n\n  async init() {\n    super.checkInitializationRequirements();\n\n    if (!this.chainConfig) {\n      this.chainConfig = (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .getChainConfig */ .h2)(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .CHAIN_NAMESPACES.EIP155 */ .EN.EIP155, 1);\n    } // Create a connector\n\n\n    this.connector = this.getWalletConnectInstance();\n    this.wcProvider = new _web3auth_ethereum_provider__WEBPACK_IMPORTED_MODULE_2__.WalletConnectProvider({\n      config: {\n        chainConfig: this.chainConfig\n      }\n    });\n    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.READY */ .n2.READY, _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WALLET_ADAPTERS.WALLET_CONNECT_V1 */ .rW.WALLET_CONNECT_V1);\n    this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.READY */ .MP.READY;\n\n    if (this.connector.connected) {\n      this.rehydrated = true;\n      await this.onConnectHandler({\n        accounts: this.connector.accounts,\n        chainId: this.connector.chainId.toString()\n      });\n    }\n  }\n\n  async connect() {\n    super.checkConnectionRequirements();\n    if (!this.connector) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.notReady */ .Ty.notReady("Wallet adapter is not ready yet");\n\n    if (this.connected) {\n      await this.onConnectHandler({\n        accounts: this.connector.accounts,\n        chainId: this.connector.chainId.toString()\n      });\n      return this.provider;\n    }\n\n    if (this.status !== _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.CONNECTING */ .MP.CONNECTING) {\n      var _this$adapterOptions$;\n\n      // for wallet connect qr code modal we have to create a new connector, coz wallet connect internally does not open\n      // modal again on existing instance if connection is pending.\n      if ((_this$adapterOptions$ = this.adapterOptions.adapterSettings) !== null && _this$adapterOptions$ !== void 0 && _this$adapterOptions$.qrcodeModal) {\n        this.connector = this.getWalletConnectInstance();\n      }\n\n      await this.createNewSession();\n      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.CONNECTING */ .MP.CONNECTING;\n      this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.CONNECTING */ .n2.CONNECTING, {\n        adapter: _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WALLET_ADAPTERS.WALLET_CONNECT_V1 */ .rW.WALLET_CONNECT_V1\n      });\n    }\n\n    return new Promise((resolve, reject) => {\n      if (!this.connector) return reject(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.notReady */ .Ty.notReady("Wallet adapter is not ready yet")); // for wallet connect default modal.\n\n      this.connector.on("modal_closed", async () => {\n        this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.READY */ .MP.READY;\n        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.READY */ .n2.READY, _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WALLET_ADAPTERS.WALLET_CONNECT_V1 */ .rW.WALLET_CONNECT_V1);\n        return reject(new Error("User closed modal"));\n      });\n\n      try {\n        // Subscribe to session connection\n        this.connector.on("connect", async (error, payload) => {\n          if (error) {\n            this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, error);\n          }\n\n          await this.onConnectHandler(payload.params[0]);\n          return resolve(this.provider);\n        });\n      } catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().error("Wallet connect v1 adapter error while connecting", error); // ready again to be connected\n\n        this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.READY */ .MP.READY;\n        this.rehydrated = true;\n        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, error);\n        reject(error instanceof _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .Web3AuthError */ .up ? error : _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletLoginError.connectionError */ .RM.connectionError("Failed to login with wallet connect: ".concat((error === null || error === void 0 ? void 0 : error.message) || "")));\n      }\n    });\n  }\n\n  async getUserInfo() {\n    if (!this.connected) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletLoginError.notConnectedError */ .RM.notConnectedError("Not connected with wallet, Please login/connect first");\n    return {};\n  }\n\n  async disconnect() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      cleanup: false\n    };\n    const {\n      cleanup\n    } = options;\n    if (!this.connector || !this.connected) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletLoginError.notConnectedError */ .RM.notConnectedError("Not connected with wallet");\n    await this.connector.killSession();\n    this.rehydrated = false;\n\n    if (cleanup) {\n      this.connector = null;\n      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.NOT_READY */ .MP.NOT_READY;\n      this.wcProvider = null;\n    } else {\n      // ready to connect again\n      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.READY */ .MP.READY;\n    }\n\n    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.DISCONNECTED */ .n2.DISCONNECTED);\n  }\n\n  async createNewSession() {\n    var _this$adapterOptions, _this$adapterOptions$2;\n\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      forceNewSession: false\n    };\n    if (!this.connector) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.notReady */ .Ty.notReady("Wallet adapter is not ready yet");\n\n    if (opts.forceNewSession && this.connector.pending) {\n      await this.connector.killSession();\n    } // for wallet connect qr modal\n\n\n    if ((_this$adapterOptions = this.adapterOptions) !== null && _this$adapterOptions !== void 0 && (_this$adapterOptions$2 = _this$adapterOptions.adapterSettings) !== null && _this$adapterOptions$2 !== void 0 && _this$adapterOptions$2.qrcodeModal) {\n      var _this$chainConfig;\n\n      await this.connector.createSession({\n        chainId: parseInt(((_this$chainConfig = this.chainConfig) === null || _this$chainConfig === void 0 ? void 0 : _this$chainConfig.chainId) || "0x1", 16)\n      });\n      return;\n    } // for web3auth qr code modal\n\n\n    return new Promise((resolve, reject) => {\n      var _this$chainConfig2;\n\n      if (!this.connector) return reject(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.notReady */ .Ty.notReady("Wallet adapter is not ready yet"));\n      loglevel__WEBPACK_IMPORTED_MODULE_3___default().debug("creating new session for web3auth wallet connect");\n      this.connector.on("display_uri", async (err, payload) => {\n        var _this$connector2;\n\n        if (err) {\n          this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletLoginError.connectionError */ .RM.connectionError("Failed to display wallet connect qr code"));\n          return reject(err);\n        }\n\n        const uri = payload.params[0];\n        this.updateAdapterData({\n          uri\n        });\n        (_this$connector2 = this.connector) === null || _this$connector2 === void 0 ? void 0 : _this$connector2.off("display_uri");\n        return resolve();\n      });\n      this.connector.createSession({\n        chainId: parseInt(((_this$chainConfig2 = this.chainConfig) === null || _this$chainConfig2 === void 0 ? void 0 : _this$chainConfig2.chainId) || "0x1", 16)\n      }).catch(error => {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().error("error while creating new wallet connect session", error);\n        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, error);\n        return reject(error);\n      });\n    });\n  }\n\n  async onConnectHandler(params) {\n    if (!this.connector || !this.wcProvider) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.notReady */ .Ty.notReady("Wallet adapter is not ready yet");\n    if (!this.chainConfig) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.invalidParams */ .Ty.invalidParams("Chain config is not set");\n    const {\n      chainId\n    } = params;\n    loglevel__WEBPACK_IMPORTED_MODULE_3___default().debug("connected chainId", chainId);\n    const connectedChainId = parseInt(chainId, (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .isHexStrict */ .H2)(chainId) ? 16 : 10);\n\n    if (connectedChainId !== parseInt(this.chainConfig.chainId, 16)) {\n      // we need to create a new session since old session is already used and\n      // user needs to login again with correct chain with new qr code.\n      await this.createNewSession({\n        forceNewSession: true\n      });\n      this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WalletInitializationError.fromCode */ .Ty.fromCode(5000, "Not connected to correct chainId. Expected: ".concat(this.chainConfig.chainId, ", Current: ").concat(connectedChainId, ", Please switch to correct chain from wallet")));\n      return;\n    }\n\n    await this.wcProvider.setupProvider(this.connector);\n    this.subscribeEvents(this.connector);\n    this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_STATUS.CONNECTED */ .MP.CONNECTED;\n    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.CONNECTED */ .n2.CONNECTED, {\n      adapter: _web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .WALLET_ADAPTERS.WALLET_CONNECT_V1 */ .rW.WALLET_CONNECT_V1,\n      reconnected: this.rehydrated\n    });\n  }\n\n  subscribeEvents(connector) {\n    connector.on("session_update", async error => {\n      if (error) {\n        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_1__/* .ADAPTER_EVENTS.ERRORED */ .n2.ERRORED, error);\n      }\n    });\n  }\n\n  getWalletConnectInstance() {\n    const walletConnectOptions = this.adapterOptions.adapterSettings || {};\n    walletConnectOptions.bridge = walletConnectOptions.bridge || "https://bridge.walletconnect.org"; // Create a connector\n\n    return new _walletconnect_client__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z(walletConnectOptions);\n  }\n\n}\n\n\n//# sourceMappingURL=walletConnectV1Adapter.esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQSxPQUFPO0FBQ1AsUUFBUSxxREFBUztBQUNqQixrQkFBa0Isb0ZBQXNCO0FBQ3hDO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTtBQUNBLG1EQUFtRCxpR0FBa0M7QUFDckYsaUNBQWlDLDJHQUF1QztBQUN4RTtBQUNBO0FBQ0EsTUFBTTtBQUNOLElBQUkscURBQVM7QUFDYiwrQ0FBK0MscUVBQVc7O0FBRTFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsZ0JBQWdCLG9GQUFzQixFQUFFLGlHQUFrQztBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0Isd0ZBQXdCO0FBQzFDLGNBQWMsd0ZBQXdCO0FBQ3RDLGVBQWUseUdBQWlDO0FBQ2hEO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixvRkFBc0I7QUFDeEM7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLHFHQUFxRzs7QUFFckcsZUFBZSxzRUFBYTtBQUM1Qjs7QUFFQTs7QUFFa0M7QUFDbEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9saW1pbmFsLWFwcC8uL25vZGVfbW9kdWxlcy9Ad2ViM2F1dGgvd2FsbGV0LWNvbm5lY3QtdjEtYWRhcHRlci9kaXN0L3dhbGxldENvbm5lY3RWMUFkYXB0ZXIuZXNtLmpzP2FlOGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5JztcbmltcG9ydCBXYWxsZXRDb25uZWN0IGZyb20gJ0B3YWxsZXRjb25uZWN0L2NsaWVudCc7XG5pbXBvcnQgeyBCYXNlQWRhcHRlciwgV0FMTEVUX0FEQVBURVJTLCBBREFQVEVSX05BTUVTUEFDRVMsIENIQUlOX05BTUVTUEFDRVMsIEFEQVBURVJfQ0FURUdPUlksIEFEQVBURVJfU1RBVFVTLCBnZXRDaGFpbkNvbmZpZywgQURBUFRFUl9FVkVOVFMsIFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IsIFdlYjNBdXRoRXJyb3IsIFdhbGxldExvZ2luRXJyb3IsIGlzSGV4U3RyaWN0IH0gZnJvbSAnQHdlYjNhdXRoL2Jhc2UnO1xuaW1wb3J0IHsgV2FsbGV0Q29ubmVjdFByb3ZpZGVyIH0gZnJvbSAnQHdlYjNhdXRoL2V0aGVyZXVtLXByb3ZpZGVyJztcbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5mdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfVxuXG5jbGFzcyBXYWxsZXRDb25uZWN0VjFBZGFwdGVyIGV4dGVuZHMgQmFzZUFkYXB0ZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgc3VwZXIoKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwgV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJOYW1lc3BhY2VcIiwgQURBUFRFUl9OQU1FU1BBQ0VTLkVJUDE1NSk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXJyZW50Q2hhaW5OYW1lc3BhY2VcIiwgQ0hBSU5fTkFNRVNQQUNFUy5FSVAxNTUpO1xuXG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwidHlwZVwiLCBBREFQVEVSX0NBVEVHT1JZLkVYVEVSTkFMKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJPcHRpb25zXCIsIHZvaWQgMCk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdGF0dXNcIiwgQURBUFRFUl9TVEFUVVMuTk9UX1JFQURZKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJEYXRhXCIsIHtcbiAgICAgIHVyaTogXCJcIlxuICAgIH0pO1xuXG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiY29ubmVjdG9yXCIsIG51bGwpO1xuXG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwid2NQcm92aWRlclwiLCBudWxsKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInJlaHlkcmF0ZWRcIiwgZmFsc2UpO1xuXG4gICAgdGhpcy5hZGFwdGVyT3B0aW9ucyA9IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMpO1xuICAgIHRoaXMuY2hhaW5Db25maWcgPSBvcHRpb25zLmNoYWluQ29uZmlnIHx8IG51bGw7XG4gIH1cblxuICBnZXQgY29ubmVjdGVkKCkge1xuICAgIHZhciBfdGhpcyRjb25uZWN0b3I7XG5cbiAgICByZXR1cm4gISEoKF90aGlzJGNvbm5lY3RvciA9IHRoaXMuY29ubmVjdG9yKSAhPT0gbnVsbCAmJiBfdGhpcyRjb25uZWN0b3IgIT09IHZvaWQgMCAmJiBfdGhpcyRjb25uZWN0b3IuY29ubmVjdGVkKTtcbiAgfVxuXG4gIGdldCBwcm92aWRlcigpIHtcbiAgICB2YXIgX3RoaXMkd2NQcm92aWRlcjtcblxuICAgIHJldHVybiAoKF90aGlzJHdjUHJvdmlkZXIgPSB0aGlzLndjUHJvdmlkZXIpID09PSBudWxsIHx8IF90aGlzJHdjUHJvdmlkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHdjUHJvdmlkZXIucHJvdmlkZXIpIHx8IG51bGw7XG4gIH1cblxuICBzZXQgcHJvdmlkZXIoXykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgfVxuXG4gIGFzeW5jIGluaXQoKSB7XG4gICAgc3VwZXIuY2hlY2tJbml0aWFsaXphdGlvblJlcXVpcmVtZW50cygpO1xuXG4gICAgaWYgKCF0aGlzLmNoYWluQ29uZmlnKSB7XG4gICAgICB0aGlzLmNoYWluQ29uZmlnID0gZ2V0Q2hhaW5Db25maWcoQ0hBSU5fTkFNRVNQQUNFUy5FSVAxNTUsIDEpO1xuICAgIH0gLy8gQ3JlYXRlIGEgY29ubmVjdG9yXG5cblxuICAgIHRoaXMuY29ubmVjdG9yID0gdGhpcy5nZXRXYWxsZXRDb25uZWN0SW5zdGFuY2UoKTtcbiAgICB0aGlzLndjUHJvdmlkZXIgPSBuZXcgV2FsbGV0Q29ubmVjdFByb3ZpZGVyKHtcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBjaGFpbkNvbmZpZzogdGhpcy5jaGFpbkNvbmZpZ1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5SRUFEWSwgV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxKTtcbiAgICB0aGlzLnN0YXR1cyA9IEFEQVBURVJfU1RBVFVTLlJFQURZO1xuXG4gICAgaWYgKHRoaXMuY29ubmVjdG9yLmNvbm5lY3RlZCkge1xuICAgICAgdGhpcy5yZWh5ZHJhdGVkID0gdHJ1ZTtcbiAgICAgIGF3YWl0IHRoaXMub25Db25uZWN0SGFuZGxlcih7XG4gICAgICAgIGFjY291bnRzOiB0aGlzLmNvbm5lY3Rvci5hY2NvdW50cyxcbiAgICAgICAgY2hhaW5JZDogdGhpcy5jb25uZWN0b3IuY2hhaW5JZC50b1N0cmluZygpXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjb25uZWN0KCkge1xuICAgIHN1cGVyLmNoZWNrQ29ubmVjdGlvblJlcXVpcmVtZW50cygpO1xuICAgIGlmICghdGhpcy5jb25uZWN0b3IpIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpO1xuXG4gICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICBhd2FpdCB0aGlzLm9uQ29ubmVjdEhhbmRsZXIoe1xuICAgICAgICBhY2NvdW50czogdGhpcy5jb25uZWN0b3IuYWNjb3VudHMsXG4gICAgICAgIGNoYWluSWQ6IHRoaXMuY29ubmVjdG9yLmNoYWluSWQudG9TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5wcm92aWRlcjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEFEQVBURVJfU1RBVFVTLkNPTk5FQ1RJTkcpIHtcbiAgICAgIHZhciBfdGhpcyRhZGFwdGVyT3B0aW9ucyQ7XG5cbiAgICAgIC8vIGZvciB3YWxsZXQgY29ubmVjdCBxciBjb2RlIG1vZGFsIHdlIGhhdmUgdG8gY3JlYXRlIGEgbmV3IGNvbm5lY3RvciwgY296IHdhbGxldCBjb25uZWN0IGludGVybmFsbHkgZG9lcyBub3Qgb3BlblxuICAgICAgLy8gbW9kYWwgYWdhaW4gb24gZXhpc3RpbmcgaW5zdGFuY2UgaWYgY29ubmVjdGlvbiBpcyBwZW5kaW5nLlxuICAgICAgaWYgKChfdGhpcyRhZGFwdGVyT3B0aW9ucyQgPSB0aGlzLmFkYXB0ZXJPcHRpb25zLmFkYXB0ZXJTZXR0aW5ncykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMkICE9PSB2b2lkIDAgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMkLnFyY29kZU1vZGFsKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdG9yID0gdGhpcy5nZXRXYWxsZXRDb25uZWN0SW5zdGFuY2UoKTtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5jcmVhdGVOZXdTZXNzaW9uKCk7XG4gICAgICB0aGlzLnN0YXR1cyA9IEFEQVBURVJfU1RBVFVTLkNPTk5FQ1RJTkc7XG4gICAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuQ09OTkVDVElORywge1xuICAgICAgICBhZGFwdGVyOiBXQUxMRVRfQURBUFRFUlMuV0FMTEVUX0NPTk5FQ1RfVjFcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAoIXRoaXMuY29ubmVjdG9yKSByZXR1cm4gcmVqZWN0KFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpKTsgLy8gZm9yIHdhbGxldCBjb25uZWN0IGRlZmF1bHQgbW9kYWwuXG5cbiAgICAgIHRoaXMuY29ubmVjdG9yLm9uKFwibW9kYWxfY2xvc2VkXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5SRUFEWTtcbiAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLlJFQURZLCBXQUxMRVRfQURBUFRFUlMuV0FMTEVUX0NPTk5FQ1RfVjEpO1xuICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihcIlVzZXIgY2xvc2VkIG1vZGFsXCIpKTtcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBTdWJzY3JpYmUgdG8gc2Vzc2lvbiBjb25uZWN0aW9uXG4gICAgICAgIHRoaXMuY29ubmVjdG9yLm9uKFwiY29ubmVjdFwiLCBhc3luYyAoZXJyb3IsIHBheWxvYWQpID0+IHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5FUlJPUkVELCBlcnJvcik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYXdhaXQgdGhpcy5vbkNvbm5lY3RIYW5kbGVyKHBheWxvYWQucGFyYW1zWzBdKTtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh0aGlzLnByb3ZpZGVyKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cuZXJyb3IoXCJXYWxsZXQgY29ubmVjdCB2MSBhZGFwdGVyIGVycm9yIHdoaWxlIGNvbm5lY3RpbmdcIiwgZXJyb3IpOyAvLyByZWFkeSBhZ2FpbiB0byBiZSBjb25uZWN0ZWRcblxuICAgICAgICB0aGlzLnN0YXR1cyA9IEFEQVBURVJfU1RBVFVTLlJFQURZO1xuICAgICAgICB0aGlzLnJlaHlkcmF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuRVJST1JFRCwgZXJyb3IpO1xuICAgICAgICByZWplY3QoZXJyb3IgaW5zdGFuY2VvZiBXZWIzQXV0aEVycm9yID8gZXJyb3IgOiBXYWxsZXRMb2dpbkVycm9yLmNvbm5lY3Rpb25FcnJvcihcIkZhaWxlZCB0byBsb2dpbiB3aXRoIHdhbGxldCBjb25uZWN0OiBcIi5jb25jYXQoKGVycm9yID09PSBudWxsIHx8IGVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlcnJvci5tZXNzYWdlKSB8fCBcIlwiKSkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckluZm8oKSB7XG4gICAgaWYgKCF0aGlzLmNvbm5lY3RlZCkgdGhyb3cgV2FsbGV0TG9naW5FcnJvci5ub3RDb25uZWN0ZWRFcnJvcihcIk5vdCBjb25uZWN0ZWQgd2l0aCB3YWxsZXQsIFBsZWFzZSBsb2dpbi9jb25uZWN0IGZpcnN0XCIpO1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIGFzeW5jIGRpc2Nvbm5lY3QoKSB7XG4gICAgbGV0IG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHtcbiAgICAgIGNsZWFudXA6IGZhbHNlXG4gICAgfTtcbiAgICBjb25zdCB7XG4gICAgICBjbGVhbnVwXG4gICAgfSA9IG9wdGlvbnM7XG4gICAgaWYgKCF0aGlzLmNvbm5lY3RvciB8fCAhdGhpcy5jb25uZWN0ZWQpIHRocm93IFdhbGxldExvZ2luRXJyb3Iubm90Q29ubmVjdGVkRXJyb3IoXCJOb3QgY29ubmVjdGVkIHdpdGggd2FsbGV0XCIpO1xuICAgIGF3YWl0IHRoaXMuY29ubmVjdG9yLmtpbGxTZXNzaW9uKCk7XG4gICAgdGhpcy5yZWh5ZHJhdGVkID0gZmFsc2U7XG5cbiAgICBpZiAoY2xlYW51cCkge1xuICAgICAgdGhpcy5jb25uZWN0b3IgPSBudWxsO1xuICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5OT1RfUkVBRFk7XG4gICAgICB0aGlzLndjUHJvdmlkZXIgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZWFkeSB0byBjb25uZWN0IGFnYWluXG4gICAgICB0aGlzLnN0YXR1cyA9IEFEQVBURVJfU1RBVFVTLlJFQURZO1xuICAgIH1cblxuICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5ESVNDT05ORUNURUQpO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlTmV3U2Vzc2lvbigpIHtcbiAgICB2YXIgX3RoaXMkYWRhcHRlck9wdGlvbnMsIF90aGlzJGFkYXB0ZXJPcHRpb25zJDI7XG5cbiAgICBsZXQgb3B0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge1xuICAgICAgZm9yY2VOZXdTZXNzaW9uOiBmYWxzZVxuICAgIH07XG4gICAgaWYgKCF0aGlzLmNvbm5lY3RvcikgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5ub3RSZWFkeShcIldhbGxldCBhZGFwdGVyIGlzIG5vdCByZWFkeSB5ZXRcIik7XG5cbiAgICBpZiAob3B0cy5mb3JjZU5ld1Nlc3Npb24gJiYgdGhpcy5jb25uZWN0b3IucGVuZGluZykge1xuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0b3Iua2lsbFNlc3Npb24oKTtcbiAgICB9IC8vIGZvciB3YWxsZXQgY29ubmVjdCBxciBtb2RhbFxuXG5cbiAgICBpZiAoKF90aGlzJGFkYXB0ZXJPcHRpb25zID0gdGhpcy5hZGFwdGVyT3B0aW9ucykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMgIT09IHZvaWQgMCAmJiAoX3RoaXMkYWRhcHRlck9wdGlvbnMkMiA9IF90aGlzJGFkYXB0ZXJPcHRpb25zLmFkYXB0ZXJTZXR0aW5ncykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMkMiAhPT0gdm9pZCAwICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zJDIucXJjb2RlTW9kYWwpIHtcbiAgICAgIHZhciBfdGhpcyRjaGFpbkNvbmZpZztcblxuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0b3IuY3JlYXRlU2Vzc2lvbih7XG4gICAgICAgIGNoYWluSWQ6IHBhcnNlSW50KCgoX3RoaXMkY2hhaW5Db25maWcgPSB0aGlzLmNoYWluQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRjaGFpbkNvbmZpZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY2hhaW5Db25maWcuY2hhaW5JZCkgfHwgXCIweDFcIiwgMTYpXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIGZvciB3ZWIzYXV0aCBxciBjb2RlIG1vZGFsXG5cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB2YXIgX3RoaXMkY2hhaW5Db25maWcyO1xuXG4gICAgICBpZiAoIXRoaXMuY29ubmVjdG9yKSByZXR1cm4gcmVqZWN0KFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpKTtcbiAgICAgIGxvZy5kZWJ1ZyhcImNyZWF0aW5nIG5ldyBzZXNzaW9uIGZvciB3ZWIzYXV0aCB3YWxsZXQgY29ubmVjdFwiKTtcbiAgICAgIHRoaXMuY29ubmVjdG9yLm9uKFwiZGlzcGxheV91cmlcIiwgYXN5bmMgKGVyciwgcGF5bG9hZCkgPT4ge1xuICAgICAgICB2YXIgX3RoaXMkY29ubmVjdG9yMjtcblxuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIFdhbGxldExvZ2luRXJyb3IuY29ubmVjdGlvbkVycm9yKFwiRmFpbGVkIHRvIGRpc3BsYXkgd2FsbGV0IGNvbm5lY3QgcXIgY29kZVwiKSk7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXJpID0gcGF5bG9hZC5wYXJhbXNbMF07XG4gICAgICAgIHRoaXMudXBkYXRlQWRhcHRlckRhdGEoe1xuICAgICAgICAgIHVyaVxuICAgICAgICB9KTtcbiAgICAgICAgKF90aGlzJGNvbm5lY3RvcjIgPSB0aGlzLmNvbm5lY3RvcikgPT09IG51bGwgfHwgX3RoaXMkY29ubmVjdG9yMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY29ubmVjdG9yMi5vZmYoXCJkaXNwbGF5X3VyaVwiKTtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jb25uZWN0b3IuY3JlYXRlU2Vzc2lvbih7XG4gICAgICAgIGNoYWluSWQ6IHBhcnNlSW50KCgoX3RoaXMkY2hhaW5Db25maWcyID0gdGhpcy5jaGFpbkNvbmZpZykgPT09IG51bGwgfHwgX3RoaXMkY2hhaW5Db25maWcyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRjaGFpbkNvbmZpZzIuY2hhaW5JZCkgfHwgXCIweDFcIiwgMTYpXG4gICAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGxvZy5lcnJvcihcImVycm9yIHdoaWxlIGNyZWF0aW5nIG5ldyB3YWxsZXQgY29ubmVjdCBzZXNzaW9uXCIsIGVycm9yKTtcbiAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIG9uQ29ubmVjdEhhbmRsZXIocGFyYW1zKSB7XG4gICAgaWYgKCF0aGlzLmNvbm5lY3RvciB8fCAhdGhpcy53Y1Byb3ZpZGVyKSB0aHJvdyBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLm5vdFJlYWR5KFwiV2FsbGV0IGFkYXB0ZXIgaXMgbm90IHJlYWR5IHlldFwiKTtcbiAgICBpZiAoIXRoaXMuY2hhaW5Db25maWcpIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuaW52YWxpZFBhcmFtcyhcIkNoYWluIGNvbmZpZyBpcyBub3Qgc2V0XCIpO1xuICAgIGNvbnN0IHtcbiAgICAgIGNoYWluSWRcbiAgICB9ID0gcGFyYW1zO1xuICAgIGxvZy5kZWJ1ZyhcImNvbm5lY3RlZCBjaGFpbklkXCIsIGNoYWluSWQpO1xuICAgIGNvbnN0IGNvbm5lY3RlZENoYWluSWQgPSBwYXJzZUludChjaGFpbklkLCBpc0hleFN0cmljdChjaGFpbklkKSA/IDE2IDogMTApO1xuXG4gICAgaWYgKGNvbm5lY3RlZENoYWluSWQgIT09IHBhcnNlSW50KHRoaXMuY2hhaW5Db25maWcuY2hhaW5JZCwgMTYpKSB7XG4gICAgICAvLyB3ZSBuZWVkIHRvIGNyZWF0ZSBhIG5ldyBzZXNzaW9uIHNpbmNlIG9sZCBzZXNzaW9uIGlzIGFscmVhZHkgdXNlZCBhbmRcbiAgICAgIC8vIHVzZXIgbmVlZHMgdG8gbG9naW4gYWdhaW4gd2l0aCBjb3JyZWN0IGNoYWluIHdpdGggbmV3IHFyIGNvZGUuXG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZU5ld1Nlc3Npb24oe1xuICAgICAgICBmb3JjZU5ld1Nlc3Npb246IHRydWVcbiAgICAgIH0pO1xuICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuZnJvbUNvZGUoNTAwMCwgXCJOb3QgY29ubmVjdGVkIHRvIGNvcnJlY3QgY2hhaW5JZC4gRXhwZWN0ZWQ6IFwiLmNvbmNhdCh0aGlzLmNoYWluQ29uZmlnLmNoYWluSWQsIFwiLCBDdXJyZW50OiBcIikuY29uY2F0KGNvbm5lY3RlZENoYWluSWQsIFwiLCBQbGVhc2Ugc3dpdGNoIHRvIGNvcnJlY3QgY2hhaW4gZnJvbSB3YWxsZXRcIikpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLndjUHJvdmlkZXIuc2V0dXBQcm92aWRlcih0aGlzLmNvbm5lY3Rvcik7XG4gICAgdGhpcy5zdWJzY3JpYmVFdmVudHModGhpcy5jb25uZWN0b3IpO1xuICAgIHRoaXMuc3RhdHVzID0gQURBUFRFUl9TVEFUVVMuQ09OTkVDVEVEO1xuICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5DT05ORUNURUQsIHtcbiAgICAgIGFkYXB0ZXI6IFdBTExFVF9BREFQVEVSUy5XQUxMRVRfQ09OTkVDVF9WMSxcbiAgICAgIHJlY29ubmVjdGVkOiB0aGlzLnJlaHlkcmF0ZWRcbiAgICB9KTtcbiAgfVxuXG4gIHN1YnNjcmliZUV2ZW50cyhjb25uZWN0b3IpIHtcbiAgICBjb25uZWN0b3Iub24oXCJzZXNzaW9uX3VwZGF0ZVwiLCBhc3luYyBlcnJvciA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldFdhbGxldENvbm5lY3RJbnN0YW5jZSgpIHtcbiAgICBjb25zdCB3YWxsZXRDb25uZWN0T3B0aW9ucyA9IHRoaXMuYWRhcHRlck9wdGlvbnMuYWRhcHRlclNldHRpbmdzIHx8IHt9O1xuICAgIHdhbGxldENvbm5lY3RPcHRpb25zLmJyaWRnZSA9IHdhbGxldENvbm5lY3RPcHRpb25zLmJyaWRnZSB8fCBcImh0dHBzOi8vYnJpZGdlLndhbGxldGNvbm5lY3Qub3JnXCI7IC8vIENyZWF0ZSBhIGNvbm5lY3RvclxuXG4gICAgcmV0dXJuIG5ldyBXYWxsZXRDb25uZWN0KHdhbGxldENvbm5lY3RPcHRpb25zKTtcbiAgfVxuXG59XG5cbmV4cG9ydCB7IFdhbGxldENvbm5lY3RWMUFkYXB0ZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdhbGxldENvbm5lY3RWMUFkYXB0ZXIuZXNtLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///21357\n')},62859:()=>{},75304:()=>{},32772:()=>{},64123:()=>{},29704:()=>{}}]);